<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€™çœŸæ˜¯ä¸€å€‹æ­£ç¶“çš„ç†è²¡ç¶²ç«™ - å€‹äººè²¡å‹™ç®¡ç†åŠ©æ‰‹</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #2980b9;
            --light: #ecf0f1;
            --dark: #34495e;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary), var(--dark));
            color: white;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .app-container {
            width: 100%;
            max-width: 1200px;
            height: 90vh;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            overflow: hidden;
            display: flex;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .sidebar {
            width: 300px;
            background: rgba(44, 62, 80, 0.8);
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .logo h1 {
            font-size: 1.8rem;
            color: var(--light);
            margin-bottom: 5px;
        }
        
        .logo p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }
        
        .auth-forms {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .auth-form {
            display: none;
        }
        
        .auth-form.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .auth-form h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.9);
        }
        
        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .btn-primary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--accent);
        }
        
        .btn-secondary {
            background: transparent;
            color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .auth-switch {
            text-align: center;
            margin-top: 15px;
            font-size: 0.9rem;
        }
        
        .auth-switch a {
            color: var(--secondary);
            cursor: pointer;
            text-decoration: underline;
        }
        
        .user-info {
            display: none;
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .user-info.active {
            display: block;
        }
        
        .user-info h3 {
            margin-bottom: 5px;
        }
        
        .user-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        .nav-menu {
            list-style: none;
            margin-top: 20px;
            display: none;
        }
        
        .nav-menu.active {
            display: block;
        }
        
        .nav-item {
            margin-bottom: 10px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover, .nav-link.active {
            background: var(--secondary);
            color: white;
        }
        
        .nav-link i {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }
        
        .welcome-message {
            text-align: center;
            padding: 50px 20px;
            display: none;
        }
        
        .welcome-message.active {
            display: block;
        }
        
        .welcome-message h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        
        .welcome-message p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto 30px;
        }
        
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-header {
            margin-bottom: 30px;
        }
        
        .section-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .section-header p {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-card.income {
            border-left: 4px solid var(--success);
        }
        
        .stat-card.expense {
            border-left: 4px solid var(--danger);
        }
        
        .stat-card.balance {
            border-left: 4px solid var(--secondary);
        }
        
        .stat-card h3 {
            font-size: 0.9rem;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .stat-card .amount {
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            height: 300px;
        }
        
        .transaction-form {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .transaction-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .transaction-item {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .transaction-item:last-child {
            border-bottom: none;
        }
        
        .transaction-info {
            display: flex;
            flex-direction: column;
        }
        
        .transaction-category {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .transaction-amount.income {
            color: var(--success);
            font-weight: bold;
        }
        
        .transaction-amount.expense {
            color: var(--danger);
            font-weight: bold;
        }
        
        .delete-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            font-size: 1rem;
        }
        
        .delete-btn:hover {
            color: var(--danger);
        }
        
        .settings-option {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.3);
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--secondary);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
                height: auto;
            }
            
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="sidebar">
            <div class="logo">
                <h1>é€™çœŸæ˜¯ä¸€å€‹æ­£ç¶“çš„ç†è²¡ç¶²ç«™</h1>
                <p>æ™ºèƒ½è´¢åŠ¡ç®¡ç†è§£å†³æ–¹æ¡ˆ</p>
            </div>
            
            <!-- è®¤è¯è¡¨å•åŒºåŸŸ -->
            <div class="auth-forms" id="auth-forms">
                <!-- ç™»å½•è¡¨å• -->
                <div class="auth-form active" id="login-form">
                    <h3>ç”¨æˆ¶ç™»éŒ„</h3>
                    <div class="form-group">
                        <label for="username">ç”¨æˆ¶å</label>
                        <input type="text" id="username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
                    </div>
                    <div class="form-group">
                        <label for="password">å¯†ç¢¼</label>
                        <input type="password" id="password" placeholder="è¯·è¾“å…¥å¯†ç ">
                    </div>
                    <button class="btn btn-primary" id="login-btn">ç™»é™¸</button>
                    <div class="auth-switch">
                        é‚„æ²’æœ‰å¸³è™Ÿï¼Ÿ<a href="register.html" target="_blank" id="show-register">ç«‹å³è¨»å†Š</a>
                    </div>
                </div>
            </div>
            
            <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸï¼ˆç™»å½•åæ˜¾ç¤ºï¼‰ -->
            <div class="user-info" id="user-info">
                <h3 id="user-greeting">æ­¡è¿ï¼Œç”¨æˆ¶ï¼</h3>
                <p id="user-email">user@example.com</p>
                <button class="btn btn-secondary" id="logout-btn">é€€å‡ºç™»å…¥</button>
            </div>
            
            <!-- å¯¼èˆªèœå•ï¼ˆç™»å½•åæ˜¾ç¤ºï¼‰ -->
            <ul class="nav-menu" id="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active" data-target="overview">
                        <i>ğŸ“Š</i> è²¡å‹™ç¸½è¦½
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-target="transactions">
                        <i>ğŸ’°</i> è¨˜å¸³ç®¡ç†
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-target="analytics">
                        <i>ğŸ“ˆ</i> çµ±è¨ˆåˆ†æ
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-target="settings">
                        <i>âš™ï¸</i> ç³»çµ±è¨­ç½®
                    </a>
                </li>
            </ul>
        </div>
        
        <div class="main-content">
            <!-- æ¬¢è¿ä¿¡æ¯ï¼ˆæœªç™»å½•æ—¶æ˜¾ç¤ºï¼‰ -->
            <div class="welcome-message active" id="welcome-message">
                <h2>æ¬¢è¿ä½¿ç”¨é€™æ˜¯ä¸€å€‹æ­£ç¶“çš„ç†è²¡ç¶²ç«™</h2>
                <p>è«‹ç™»å…¥æˆ–è¨»å†Šå¸³æˆ¶é–‹å§‹ç®¡ç†æ‚¨çš„è²¡å‹™ã€‚æˆ‘å€‘æä¾›å®Œæ•´çš„æ”¶å…¥æ”¯å‡ºè·Ÿè¹¤ã€å¯è¦–åŒ–åœ–è¡¨å’Œè²¡å‹™åˆ†æåŠŸèƒ½ï¼Œå¹«åŠ©æ‚¨æ›´å¥½çš„æŒæ¡å€‹äººè²¡å‹™ç‹€æ³ã€‚</p>
                <div style="margin-top: 40px;">
                    <h3>åŠŸèƒ½ç‰¹è‰²</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;">ğŸ“Š</div>
                            <h4>è²¡å‹™ç¸½è¦½</h4>
                            <p style="font-size: 0.9rem;">ä¸€ç›®ç­ç„¶çš„æ”¶å…¥å’Œæ”¯å‡ºçµ±è¨ˆ</p>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;">ğŸ’°</div>
                            <h4>è¨˜å¸³ç®¡ç†</h4>
                            <p style="font-size: 0.9rem;">è¼•é¬†ç´€éŒ„æ¯ä¸€ç­†æ”¶æ”¯</p>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;">ğŸ“ˆ</div>
                            <h4>çµ±è¨ˆåˆ†æ</h4>
                            <p style="font-size: 0.9rem;">æ·±å…¥ç­è§£æ¶ˆè²»ç¿’æ…£</p>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;">âš™ï¸</div>
                            <h4>å€‹æ€§åŒ–è¨­ç½®</h4>
                            <p style="font-size: 0.9rem;">è¨‚è£½æ‚¨çš„ç†è²¡é«”é©—</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- è´¢åŠ¡æ€»è§ˆéƒ¨åˆ† -->
            <div class="content-section" id="overview">
                <div class="section-header">
                    <h2>è²¡å‹™ç¸½è¦½</h2>
                    <p>æŸ¥çœ‹æ‚¨çš„æ•´é«”è²¡å‹™ç‹€æ³å’Œè¿‘æœŸæ´»å‹•</p>
                </div>
                
                <div class="stats-cards">
                    <div class="stat-card income">
                        <h3>ç¸½æ”¶å…¥</h3>
                        <div class="amount" id="total-income">Â¥0.00</div>
                    </div>
                    <div class="stat-card expense">
                        <h3>ç¸½æ”¯å‡º</h3>
                        <div class="amount" id="total-expense">Â¥0.00</div>
                    </div>
                    <div class="stat-card balance">
                        <h3>ç•¶å‰é¤˜é¡</h3>
                        <div class="amount" id="balance">Â¥0.00</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="overview-chart"></canvas>
                </div>
                
                <div class="section-header">
                    <h3>æœ€è¿‘äº¤æ˜“</h3>
                </div>
                
                <div class="transaction-list" id="overview-transactions">
                    <!-- äº¤æ˜“è®°å½•å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- è®°è´¦ç®¡ç†éƒ¨åˆ† -->
            <div class="content-section" id="transactions">
                <div class="section-header">
                    <h2>è¨˜å¸³ç®¡ç†</h2>
                    <p>ç´€éŒ„æ‚¨çš„æ¯ä¸€ç­†æ”¶å…¥å’Œæ”¯å‡º</p>
                </div>
                
                <div class="transaction-form">
                    <h3>æ·»åŠ æ–°ç´€éŒ„</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="type">é¡å‹</label>
                            <select id="type">
                                <option value="income">æ”¶å…¥</option>
                                <option value="expense">æ”¯å‡º</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="amount">é‡‘é¡</label>
                            <input type="number" id="amount" step="0.01" min="0" placeholder="0.00">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="category">åˆ†é¡</label>
                            <select id="category">
                                <option value="salary">å·¥è³‡</option>
                                <option value="investment">æŠ•è³‡</option>
                                <option value="gift">ç¦®ç‰©</option>
                                <option value="other-income">å…¶ä»–æ”¶å…¥</option>
                                <option value="food">é¤é£²</option>
                                <option value="shopping">è³¼ç‰©</option>
                                <option value="transportation">äº¤é€š</option>
                                <option value="entertainment">å¨›æ¨‚</option>
                                <option value="housing">ä½æˆ¿</option>
                                <option value="other-expense">å…¶ä»–æ”¯å‡º</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="date">æ—¥æœŸ</label>
                            <input type="date" id="date">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">æè¿°</label>
                        <input type="text" id="description" placeholder="ç°¡è¦èªªæ˜">
                    </div>
                    
                    <button class="btn btn-primary" id="add-transaction">æ·»åŠ ç´€éŒ„</button>
                </div>
                
                <div class="section-header">
                    <h3>æ‰€æœ‰äº¤æ˜“ç´€éŒ„</h3>
                </div>
                
                <div class="transaction-list" id="all-transactions">
                    <!-- äº¤æ˜“è®°å½•å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- ç»Ÿè®¡åˆ†æéƒ¨åˆ† -->
            <div class="content-section" id="analytics">
                <div class="section-header">
                    <h2>çµ±è¨ˆåˆ†æ</h2>
                    <p>æ·±å…¥ç­è§£æ‚¨çš„æ¶ˆè²»ç¿’æ…£å’Œè²¡å‹™è¶¨å‹¢</p>
                </div>
                
                <div class="stats-cards">
                    <div class="stat-card">
                        <h3>æœ¬æœˆæ”¯å‡º</h3>
                        <div class="amount" id="month-expense">Â¥0.00</div>
                    </div>
                    <div class="stat-card">
                        <h3>æœ¬æœˆæ”¶å…¥</h3>
                        <div class="amount" id="month-income">Â¥0.00</div>
                    </div>
                    <div class="stat-card">
                        <h3>æœ€å¤§æ”¯å‡ºé¡åˆ¥</h3>
                        <div class="amount" id="top-category">-</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="analytics-chart"></canvas>
                </div>
                
                <div class="chart-container">
                    <canvas id="category-chart"></canvas>
                </div>
            </div>
            
            <!-- ç³»ç»Ÿè®¾ç½®éƒ¨åˆ† -->
            <div class="content-section" id="settings">
                <div class="section-header">
                    <h2>ç³»çµ±è¨­ç½®</h2>
                    <p>å€‹æ€§åŒ–æ‚¨çš„ç†è²¡æ‡‰ç”¨é«”é©—</p>
                </div>
                
                <div class="settings-option">
                    <div>
                        <h3>æ·±è‰²æ¨¡å¼</h3>
                        <p>å•Ÿç”¨æ·±è‰²ä¸»é¡Œä»‹é¢</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-option">
                    <div>
                        <h3>é ç®—æé†’</h3>
                        <p>ç•¶æ¥è¿‘é ç®—é™åˆ¶æ™‚ç™¼é€é€šçŸ¥</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-option">
                    <div>
                        <h3>æ•¸æ“šå‚™ä»½</h3>
                        <p>è‡ªå‹•å‚™ä»½æ•¸æ“šåˆ°é›²ç«¯</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-option">
                    <div>
                        <h3>è²¨å¹£å–®ä½</h3>
                        <p>è¨­ç½®é»˜èªè²¨å¹£é¡¯ç¤º</p>
                    </div>
                    <select style="padding: 5px 10px; border-radius: 5px; background: rgba(255,255,255,0.9);">
                        <option>æ–°å°å¹£ (TWD)</option>
                        <option>äººæ°‘å¹£ (CNY)</option>
                        <option>ç¾å…ƒ (USD)</option>
                        <option>æ­å…ƒ (EUR)</option>
                        <option>æ—¥å…ƒ (JPY)</option>
                    </select>
                </div>
                
                <div class="settings-option">
                    <div>
                        <h3>èªè¨€è¨­ç½®</h3>
                        <p>é¸æ“‡ä»‹é¢é¡¯ç¤ºèªè¨€</p>
                    </div>
                    <select style="padding: 5px 10px; border-radius: 5px; background: rgba(255,255,255,0.9);">
                        <option>ç¹é«”ä¸­æ–‡</option>
                        <option>ç°¡é«”ä¸­æ–‡</option>
                        <option>English</option>
                        <option>æ—¥æœ¬èª</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ•°æ®ç®¡ç†
        const DataManager = {
            // åˆå§‹åŒ–æ•°æ®
            init() {
                if (!localStorage.getItem('users')) {
                    localStorage.setItem('users', JSON.stringify({}));
                }
                if (!localStorage.getItem('currentUser')) {
                    localStorage.setItem('currentUser', '');
                }
            },
            
            // æ³¨å†Œç”¨æˆ·
            registerUser(username, email, password) {
                const users = JSON.parse(localStorage.getItem('users'));
                
                if (users[username]) {
                    return { success: false, message: 'ç”¨æˆ·åå·²å­˜åœ¨' };
                }
                
                users[username] = {
                    email,
                    password, // æ³¨æ„ï¼šå®é™…åº”ç”¨ä¸­åº”è¯¥åŠ å¯†å­˜å‚¨å¯†ç 
                    transactions: [],
                    settings: {}
                };
                
                localStorage.setItem('users', JSON.stringify(users));
                return { success: true, message: 'æ³¨å†ŒæˆåŠŸ' };
            },
            
            // ç™»å½•ç”¨æˆ·
            loginUser(username, password) {
                const users = JSON.parse(localStorage.getItem('users'));
                
                if (!users[username]) {
                    return { success: false, message: 'ç”¨æˆ·ä¸å­˜åœ¨' };
                }
                
                if (users[username].password !== password) {
                    return { success: false, message: 'å¯†ç é”™è¯¯' };
                }
                
                localStorage.setItem('currentUser', username);
                return { success: true, message: 'ç™»å½•æˆåŠŸ', user: users[username] };
            },
            
            // è·å–å½“å‰ç”¨æˆ·
            getCurrentUser() {
                const username = localStorage.getItem('currentUser');
                if (!username) return null;
                
                const users = JSON.parse(localStorage.getItem('users'));
                return users[username] ? { username, ...users[username] } : null;
            },
            
            // é€€å‡ºç™»å½•
            logout() {
                localStorage.setItem('currentUser', '');
            },
            
            // æ·»åŠ äº¤æ˜“è®°å½•
            addTransaction(transaction) {
                const currentUser = this.getCurrentUser();
                if (!currentUser) return { success: false, message: 'ç”¨æˆ·æœªç™»å½•' };
                
                const users = JSON.parse(localStorage.getItem('users'));
                transaction.id = Date.now();
                users[currentUser.username].transactions.push(transaction);
                
                localStorage.setItem('users', JSON.stringify(users));
                return { success: true, message: 'è®°å½•æ·»åŠ æˆåŠŸ' };
            },
            
            // åˆ é™¤äº¤æ˜“è®°å½•
            deleteTransaction(id) {
                const currentUser = this.getCurrentUser();
                if (!currentUser) return { success: false, message: 'ç”¨æˆ·æœªç™»å½•' };
                
                const users = JSON.parse(localStorage.getItem('users'));
                users[currentUser.username].transactions = users[currentUser.username].transactions.filter(t => t.id !== id);
                
                localStorage.setItem('users', JSON.stringify(users));
                return { success: true, message: 'è®°å½•åˆ é™¤æˆåŠŸ' };
            },
            
            // è·å–ç”¨æˆ·äº¤æ˜“è®°å½•
            getUserTransactions() {
                const currentUser = this.getCurrentUser();
                return currentUser ? currentUser.transactions : [];
            }
        };

        // UIç®¡ç†å™¨
        const UIManager = {
            // åˆå§‹åŒ–UI
            init() {
                this.checkLoginStatus();
                this.setupEventListeners();
                
                // åˆå§‹åŒ–æ—¥æœŸä¸ºä»Šå¤©
                document.getElementById('date').valueAsDate = new Date();
            },
            
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            checkLoginStatus() {
                const currentUser = DataManager.getCurrentUser();
                
                if (currentUser) {
                    this.showLoggedInState(currentUser);
                } else {
                    this.showLoggedOutState();
                }
            },
            
            // æ˜¾ç¤ºå·²ç™»å½•çŠ¶æ€
            showLoggedInState(user) {
                // æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯å’Œå¯¼èˆªèœå•
                document.getElementById('user-info').classList.add('active');
                document.getElementById('nav-menu').classList.add('active');
                
                // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
                document.getElementById('user-greeting').textContent = `æ¬¢è¿ï¼Œ${user.username}ï¼`;
                document.getElementById('user-email').textContent = user.email;
                
                // éšè—è®¤è¯è¡¨å•å’Œæ¬¢è¿ä¿¡æ¯
                document.getElementById('auth-forms').style.display = 'none';
                document.getElementById('welcome-message').classList.remove('active');
                
                // æ˜¾ç¤ºé»˜è®¤å†…å®¹åŒºåŸŸ
                this.showContentSection('overview');
                
                // æ›´æ–°UIæ•°æ®
                this.updateUI();
            },
            
            // æ˜¾ç¤ºæœªç™»å½•çŠ¶æ€
            showLoggedOutState() {
                // éšè—ç”¨æˆ·ä¿¡æ¯å’Œå¯¼èˆªèœå•
                document.getElementById('user-info').classList.remove('active');
                document.getElementById('nav-menu').classList.remove('active');
                
                // æ˜¾ç¤ºè®¤è¯è¡¨å•å’Œæ¬¢è¿ä¿¡æ¯
                document.getElementById('auth-forms').style.display = 'block';
                document.getElementById('welcome-message').classList.add('active');
                
                // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // æ˜¾ç¤ºç™»å½•è¡¨å•
                this.showAuthForm('login');
            },
            
            // æ˜¾ç¤ºè®¤è¯è¡¨å•
            showAuthForm(formType) {
                document.querySelectorAll('.auth-form').forEach(form => {
                    form.classList.remove('active');
                });
                
                document.getElementById(`${formType}-form`).classList.add('active');
            },
            
            // æ˜¾ç¤ºå†…å®¹åŒºåŸŸ
            showContentSection(sectionId) {
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                
                document.getElementById(sectionId).classList.add('active');
                document.querySelector(`[data-target="${sectionId}"]`).classList.add('active');
            },
            
            // æ›´æ–°UIæ•°æ®
            updateUI() {
                const transactions = DataManager.getUserTransactions();
                
                // è®¡ç®—æ€»é¢
                const totalIncome = transactions
                    .filter(t => t.type === 'income')
                    .reduce((sum, t) => sum + parseFloat(t.amount), 0);
                    
                const totalExpense = transactions
                    .filter(t => t.type === 'expense')
                    .reduce((sum, t) => sum + parseFloat(t.amount), 0);
                    
                const balance = totalIncome - totalExpense;
                
                // æ›´æ–°æ€»é¢æ˜¾ç¤º
                document.getElementById('total-income').textContent = `Â¥${totalIncome.toFixed(2)}`;
                document.getElementById('total-expense').textContent = `Â¥${totalExpense.toFixed(2)}`;
                document.getElementById('balance').textContent = `Â¥${balance.toFixed(2)}`;
                
                // æ›´æ–°äº¤æ˜“åˆ—è¡¨
                this.updateTransactionList(transactions);
                
                // æ›´æ–°å›¾è¡¨
                this.updateCharts(transactions);
            },
            
            // æ›´æ–°äº¤æ˜“åˆ—è¡¨
            updateTransactionList(transactions) {
                const overviewList = document.getElementById('overview-transactions');
                const allList = document.getElementById('all-transactions');
                
                // æ¸…ç©ºåˆ—è¡¨
                overviewList.innerHTML = '';
                allList.innerHTML = '';
                
                if (transactions.length === 0) {
                    overviewList.innerHTML = '<p style="text-align: center; color: rgba(255, 255, 255, 0.7); padding: 20px;">æš‚æ— äº¤æ˜“è®°å½•</p>';
                    allList.innerHTML = '<p style="text-align: center; color: rgba(255, 255, 255, 0.7); padding: 20px;">æš‚æ— äº¤æ˜“è®°å½•</p>';
                    return;
                }
                
                // æŒ‰æ—¥æœŸæ’åºï¼ˆæœ€æ–°çš„åœ¨å‰é¢ï¼‰
                const sortedTransactions = [...transactions].sort((a, b) => new Date(b.date) - new Date(a.date));
                
                // æ›´æ–°æ€»è§ˆä¸­çš„æœ€è¿‘äº¤æ˜“ï¼ˆåªæ˜¾ç¤ºå‰5æ¡ï¼‰
                const recentTransactions = sortedTransactions.slice(0, 5);
                recentTransactions.forEach(transaction => {
                    overviewList.appendChild(this.createTransactionElement(transaction));
                });
                
                // æ›´æ–°æ‰€æœ‰äº¤æ˜“è®°å½•
                sortedTransactions.forEach(transaction => {
                    allList.appendChild(this.createTransactionElement(transaction));
                });
            },
            
            // åˆ›å»ºäº¤æ˜“å…ƒç´ 
            createTransactionElement(transaction) {
                const transactionEl = document.createElement('div');
                transactionEl.className = 'transaction-item';
                
                const date = new Date(transaction.date).toLocaleDateString('zh-CN');
                const categoryName = this.getCategoryName(transaction.category);
                
                transactionEl.innerHTML = `
                    <div class="transaction-info">
                        <div class="transaction-description">${transaction.description || categoryName}</div>
                        <div class="transaction-category">${categoryName} â€¢ ${date}</div>
                    </div>
                    <div class="transaction-amount ${transaction.type}">
                        ${transaction.type === 'income' ? '+' : '-'}Â¥${parseFloat(transaction.amount).toFixed(2)}
                    </div>
                    <button class="delete-btn" data-id="${transaction.id}">Ã—</button>
                `;
                
                // æ·»åŠ åˆ é™¤äº‹ä»¶ç›‘å¬
                const deleteBtn = transactionEl.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', () => {
                    const result = DataManager.deleteTransaction(transaction.id);
                    if (result.success) {
                        this.updateUI();
                    } else {
                        alert(result.message);
                    }
                });
                
                return transactionEl;
            },
            
            // è·å–åˆ†ç±»åç§°
            getCategoryName(category) {
                const categoryNames = {
                    'salary': 'å·¥èµ„',
                    'investment': 'æŠ•èµ„',
                    'gift': 'ç¤¼ç‰©',
                    'other-income': 'å…¶ä»–æ”¶å…¥',
                    'food': 'é¤é¥®',
                    'shopping': 'è´­ç‰©',
                    'transportation': 'äº¤é€š',
                    'entertainment': 'å¨±ä¹',
                    'housing': 'ä½æˆ¿',
                    'other-expense': 'å…¶ä»–æ”¯å‡º'
                };
                
                return categoryNames[category] || category;
            },
            
            // æ›´æ–°å›¾è¡¨
            updateCharts(transactions) {
                // è¿™é‡Œåº”è¯¥æ›´æ–°å›¾è¡¨æ•°æ®
                // ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬åªåˆå§‹åŒ–ä¸€æ¬¡å›¾è¡¨
                this.initCharts();
            },
            
            // åˆå§‹åŒ–å›¾è¡¨
            initCharts() {
                // æ€»è§ˆå›¾è¡¨
                const overviewCtx = document.getElementById('overview-chart').getContext('2d');
                const overviewChart = new Chart(overviewCtx, {
                    type: 'line',
                    data: {
                        labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ'],
                        datasets: [{
                            label: 'æ”¶å…¥',
                            data: [8500, 8200, 8800, 8700, 9000, 9200, 8900, 9100, 9500, 9800, 10200],
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'æ”¯å‡º',
                            data: [6200, 5800, 6500, 6300, 6700, 6900, 7100, 6800, 7200, 7500, 7800],
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    color: 'white'
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: 'white'
                                }
                            },
                            x: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: 'white'
                                }
                            }
                        }
                    }
                });
                
                // åˆ†æå›¾è¡¨
                const analyticsCtx = document.getElementById('analytics-chart').getContext('2d');
                const analyticsChart = new Chart(analyticsCtx, {
                    type: 'bar',
                    data: {
                        labels: ['é£Ÿå“', 'ä½æˆ¿', 'äº¤é€š', 'å¨›æ¨‚', 'è³¼ç‰©', 'é†«ç™‚'],
                        datasets: [{
                            label: 'æ”¯å‡ºé‡‘é¡',
                            data: [1250, 2500, 800, 650, 1200, 450],
                            backgroundColor: [
                                'rgba(52, 152, 219, 0.7)',
                                'rgba(155, 89, 182, 0.7)',
                                'rgba(52, 73, 94, 0.7)',
                                'rgba(241, 196, 15, 0.7)',
                                'rgba(230, 126, 34, 0.7)',
                                'rgba(231, 76, 60, 0.7)'
                            ],
                            borderColor: [
                                'rgb(52, 152, 219)',
                                'rgb(155, 89, 182)',
                                'rgb(52, 73, 94)',
                                'rgb(241, 196, 15)',
                                'rgb(230, 126, 34)',
                                'rgb(231, 76, 60)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: 'white'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                },
                                ticks: {
                                    color: 'white'
                                }
                            }
                        }
                    }
                });
                
                // åˆ†ç±»å›¾è¡¨
                const categoryCtx = document.getElementById('category-chart').getContext('2d');
                const categoryChart = new Chart(categoryCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['é£Ÿå“', 'ä½æˆ¿', 'äº¤é€š', 'å¨›æ¨‚', 'è³¼ç‰©', 'é†«ç™‚', 'å…¶ä»–'],
                        datasets: [{
                            data: [18, 35, 12, 9, 17, 6, 3],
                            backgroundColor: [
                                'rgba(52, 152, 219, 0.7)',
                                'rgba(155, 89, 182, 0.7)',
                                'rgba(52, 73, 94, 0.7)',
                                'rgba(241, 196, 15, 0.7)',
                                'rgba(230, 126, 34, 0.7)',
                                'rgba(231, 76, 60, 0.7)',
                                'rgba(149, 165, 166, 0.7)'
                            ],
                            borderColor: [
                                'rgb(52, 152, 219)',
                                'rgb(155, 89, 182)',
                                'rgb(52, 73, 94)',
                                'rgb(241, 196, 15)',
                                'rgb(230, 126, 34)',
                                'rgb(231, 76, 60)',
                                'rgb(149, 165, 166)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: 'white',
                                    padding: 15
                                }
                            }
                        }
                    }
                });
            },
            
            // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
            setupEventListeners() {
                // ç™»å½•æŒ‰é’®
                document.getElementById('login-btn').addEventListener('click', () => {
                    const username = document.getElementById('username').value;
                    const password = document.getElementById('password').value;
                    
                    if (!username || !password) {
                        alert('è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ');
                        return;
                    }
                    
                    const result = DataManager.loginUser(username, password);
                    
                    if (result.success) {
                        this.showLoggedInState(result.user);
                    } else {
                        alert(result.message);
                    }
                });
                
                // é€€å‡ºç™»å½•æŒ‰é’®
                document.getElementById('logout-btn').addEventListener('click', () => {
                    DataManager.logout();
                    this.showLoggedOutState();
                });
                
                // å¯¼èˆªèœå•åˆ‡æ¢
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        const targetId = this.getAttribute('data-target');
                        UIManager.showContentSection(targetId);
                    });
                });
                
                // æ·»åŠ äº¤æ˜“è®°å½•æŒ‰é’®
                document.getElementById('add-transaction').addEventListener('click', () => {
                    const type = document.getElementById('type').value;
                    const amount = document.getElementById('amount').value;
                    const category = document.getElementById('category').value;
                    const description = document.getElementById('description').value;
                    const date = document.getElementById('date').value;
                    
                    if (!amount || !date) {
                        alert('è¯·å¡«å†™é‡‘é¢å’Œæ—¥æœŸ');
                        return;
                    }
                    
                    const transaction = {
                        type,
                        amount: parseFloat(amount),
                        category,
                        description,
                        date
                    };
                    
                    const result = DataManager.addTransaction(transaction);
                    
                    if (result.success) {
                        // æ¸…ç©ºè¡¨å•
                        document.getElementById('amount').value = '';
                        document.getElementById('description').value = '';
                        document.getElementById('date').valueAsDate = new Date();
                        
                        // æ›´æ–°UI
                        this.updateUI();
                    } else {
                        alert(result.message);
                    }
                });
            }
        };

        // åˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', () => {
            DataManager.init();
            UIManager.init();
        });
    </script>
</body>
</html>